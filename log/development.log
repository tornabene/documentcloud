

Started GET "/home" for 127.0.0.1 at 2014-02-26 16:01:06 +0100
  [1m[36mActiveRecord::SchemaMigration Load (62.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by HomeController#index as HTML
  [1m[35mSQL (9.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (3.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mDocument Load (9.9ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (10.1ms)
  Rendered common/_meta_tags.html.erb (0.3ms)
  Rendered home/_nav.html.erb (0.5ms)
  [1m[36mSQL (1.8ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.6ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (1.7ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (51.0ms)
  Rendered home/_footer.html.erb (1.3ms)
  Rendered common/_bootstrap.html.erb (1.6ms)
Completed 200 OK in 258ms (Views: 79.3ms | ActiveRecord: 63.9ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:06 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 1562ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:01:10 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (1.1ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.4ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.7ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.5ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered accounts/_language_settings.html.erb (0.4ms)
  [1m[36mMembership Load (1.4ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (1.4ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (1.2ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (11.7ms)
  [1m[36mProject Load (1.6ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.8ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.5ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (54.3ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.9ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (0.8ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (217.0ms)
Completed 200 OK in 265ms (Views: 154.0ms | ActiveRecord: 89.7ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:10 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:11 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.1ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (1.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.7ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 126ms (Views: 64.8ms | ActiveRecord: 22.2ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:12 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.4ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (2.5ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 54ms (Views: 21.3ms | ActiveRecord: 14.5ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:01:15 +0100
Processing by HomeController#index as HTML
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mDocument Load (0.7ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (11.2ms)
  Rendered home/_footer.html.erb (0.1ms)
  Rendered common/_bootstrap.html.erb (0.2ms)
Completed 200 OK in 45ms (Views: 30.7ms | ActiveRecord: 5.2ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:15 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:01:17 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.2ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.2ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.0ms)
  [1m[36mMembership Load (0.3ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (0.5ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (4.2ms)
  [1m[36mProject Load (0.8ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.7ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.6ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (1.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (23.0ms)
Completed 200 OK in 50ms (Views: 24.6ms | ActiveRecord: 13.7ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:17 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:17 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.1ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 43ms (Views: 20.5ms | ActiveRecord: 8.2ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:18 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.1ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.7ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 48ms (Views: 23.0ms | ActiveRecord: 9.6ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:01:18 +0100
Processing by HomeController#index as HTML
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mDocument Load (1.4ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (8.4ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 34ms (Views: 18.2ms | ActiveRecord: 5.7ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:18 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:01:20 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.5ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.6ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.1ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered accounts/_language_settings.html.erb (0.2ms)
  [1m[36mMembership Load (0.6ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (1.2ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (5.3ms)
  [1m[36mProject Load (0.8ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.5ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.1ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (0.9ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (0.5ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (34.8ms)
Completed 200 OK in 91ms (Views: 48.8ms | ActiveRecord: 17.7ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:20 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:20 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.7ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.8ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 66ms (Views: 39.8ms | ActiveRecord: 11.2ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:21 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (3.2ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 66ms (Views: 28.9ms | ActiveRecord: 18.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:01:31 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (26.4ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (1.3ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (1.1ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 58ms (Views: 0.9ms | ActiveRecord: 34.9ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:01:33 +0100
Processing by HomeController#index as HTML
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mDocument Load (1.1ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.2ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (6.8ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 44ms (Views: 28.2ms | ActiveRecord: 6.4ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:33 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:01:35 +0100
Processing by WorkspaceController#index as HTML
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.3ms)[0m  SELECT name, slug FROM "organizations"
  [1m[36mDocument Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1[0m
  Rendered workspace/index.html.erb within layouts/workspace (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.1ms)
  [1m[35mMembership Load (0.6ms)[0m  SELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1  [["account_id", 1]]
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1[0m  [["account_id", 1]]
  [1m[35m (1.2ms)[0m   select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (5.8ms)
  [1m[35mProject Load (0.9ms)[0m  SELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))
  [1m[36mAccount Load (0.8ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)[0m
  [1m[35mCollaboration Load (0.7ms)[0m  SELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)
  [1m[36mAnnotation Count (1.2ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 4]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 4]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.6ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 6]]
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 6]]
  [1m[36mAnnotation Count (1.1ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 7]]
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 7]]
  [1m[35mAnnotation Count (1.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 8]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (41.7ms)
Completed 200 OK in 65ms (Views: 40.2ms | ActiveRecord: 16.5ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:35 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:36 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.7ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (1.4ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 41ms (Views: 17.9ms | ActiveRecord: 8.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:01:37 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.8ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (1.6ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 47ms (Views: 18.2ms | ActiveRecord: 10.3ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:01:40 +0100
Processing by HomeController#index as HTML
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mDocument Load (0.6ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (6.3ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 37ms (Views: 25.7ms | ActiveRecord: 5.8ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:01:40 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 9ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:07:56 +0100
Processing by HomeController#index as HTML
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mDocument Load (1.3ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (6.1ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 47ms (Views: 27.2ms | ActiveRecord: 6.3ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:07:56 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:07:58 +0100
Processing by WorkspaceController#index as HTML
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.7ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.6ms)[0m  SELECT name, slug FROM "organizations"
  [1m[36mDocument Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1[0m
  Rendered workspace/index.html.erb within layouts/workspace (0.1ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered accounts/_language_settings.html.erb (0.2ms)
  [1m[35mMembership Load (0.7ms)[0m  SELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1  [["account_id", 1]]
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1[0m  [["account_id", 1]]
  [1m[35m (1.2ms)[0m   select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (5.4ms)
  [1m[35mProject Load (0.9ms)[0m  SELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))
  [1m[36mAccount Load (0.7ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)[0m
  [1m[35mCollaboration Load (0.5ms)[0m  SELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)
  [1m[36mAnnotation Count (1.1ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 4]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 4]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 6]]
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 6]]
  [1m[36mAnnotation Count (0.9ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 7]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 7]]
  [1m[35mAnnotation Count (0.9ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 8]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (25.1ms)
Completed 200 OK in 72ms (Views: 29.9ms | ActiveRecord: 18.5ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:07:58 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:07:59 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.1ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.9ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (3.6ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 62ms (Views: 20.9ms | ActiveRecord: 10.5ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:08:00 +0100
Processing by HomeController#index as HTML
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mDocument Load (1.4ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.1ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (11.9ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 47ms (Views: 31.4ms | ActiveRecord: 6.8ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:08:00 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:10:00 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by WorkspaceController#index as HTML
Redirected to http://document.ipublic.org/home
Completed 302 Found in 3ms (ActiveRecord: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:10:00 +0100
Processing by HomeController#index as HTML
  [1m[35mDocument Load (3.0ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (1.3ms)
  Rendered common/_meta_tags.html.erb (0.2ms)
  Rendered home/_nav.html.erb (0.5ms)
  Rendered home/_sidebar.html.erb (0.8ms)
  Rendered home/_footer.html.erb (0.3ms)
  Rendered common/_bootstrap.html.erb (0.6ms)
Completed 200 OK in 54ms (Views: 23.3ms | ActiveRecord: 3.0ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:10:01 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 798ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:10:13 +0100
Processing by WorkspaceController#index as HTML
Redirected to https://document.ipublic.org/home
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:10:13 +0100
Processing by HomeController#index as HTML
  [1m[36mDocument Load (1.3ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.0ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered home/_nav.html.erb (0.1ms)
  Rendered home/_sidebar.html.erb (0.2ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 21ms (Views: 16.7ms | ActiveRecord: 1.3ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:10:14 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started POST "/login" for 127.0.0.1 at 2014-02-26 16:10:23 +0100
Processing by AuthenticationController#login as HTML
  Parameters: {"authenticity_token"=>"znSO9ZV8im4e2euKOqMo1emUFrpk0twpJ/JqUgRtjn8=", "email"=>"tindaro.tornabene@ietservizi.it", "password"=>"[FILTERED]"}
  [1m[35mSQL (2.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (2.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (1.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mMembership Load (1.3ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."organization_id" = 1 ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
Redirected to https://dev.dcloud.org/
Completed 302 Found in 121ms (ActiveRecord: 21.2ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:10:23 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.8ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.6ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.5ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered accounts/_language_settings.html.erb (0.6ms)
  [1m[36mMembership Load (1.4ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (1.4ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (1.3ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (11.6ms)
  [1m[36mProject Load (1.4ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.8ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.2ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (2.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (0.8ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (0.4ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (120.7ms)
Completed 200 OK in 174ms (Views: 113.6ms | ActiveRecord: 35.7ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:10:24 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:24 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.9ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 105ms (Views: 53.6ms | ActiveRecord: 16.3ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:25 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.5ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 49ms (Views: 23.8ms | ActiveRecord: 8.9ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:28 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (2.8ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 78ms (Views: 40.4ms | ActiveRecord: 19.2ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:29 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.4ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.8ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 94ms (Views: 54.7ms | ActiveRecord: 17.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:29 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.7ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (2.2ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (3.3ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 96ms (Views: 44.7ms | ActiveRecord: 20.8ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:30 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (2.4ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 65ms (Views: 29.2ms | ActiveRecord: 15.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:31 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.3ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.9ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.8ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.7ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 53ms (Views: 21.5ms | ActiveRecord: 13.2ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:10:33 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.2ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.2ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.1ms)
  [1m[36mMembership Load (0.4ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (0.6ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (4.4ms)
  [1m[36mProject Load (0.4ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.3ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.3ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (0.5ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (0.9ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (0.9ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (20.5ms)
Completed 200 OK in 54ms (Views: 31.2ms | ActiveRecord: 11.0ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:10:33 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 609ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:35 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.9ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 55ms (Views: 28.5ms | ActiveRecord: 11.6ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:10:35 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 59ms (Views: 25.3ms | ActiveRecord: 11.7ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:10:45 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.6ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (1.0ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (1.1ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 42ms (Views: 2.1ms | ActiveRecord: 10.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:10:55 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.5ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 49ms (Views: 2.6ms | ActiveRecord: 12.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:11:05 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.6ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.4ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 27ms (Views: 1.1ms | ActiveRecord: 11.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:11:15 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.7ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 40ms (Views: 2.3ms | ActiveRecord: 11.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:11:25 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.7ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 46ms (Views: 2.3ms | ActiveRecord: 12.7ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:11:35 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.9ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 31ms (Views: 2.2ms | ActiveRecord: 8.2ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:21:03 +0100
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (3.1ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (1.7ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (1.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.6ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (1.4ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (1.2ms)
  Rendered common/_meta_tags.html.erb (0.2ms)
  Rendered accounts/_language_settings.html.erb (0.3ms)
  [1m[36mMembership Load (1.4ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (1.4ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (1.2ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (11.8ms)
  [1m[36mProject Load (1.7ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.9ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.5ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (2.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.7ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.1ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (1.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (1.1ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (147.4ms)
Completed 200 OK in 348ms (Views: 139.2ms | ActiveRecord: 54.8ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:21:03 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 867ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:21:05 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.9ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (2.1ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (1.0ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (1.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.8ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.8ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 130ms (Views: 54.2ms | ActiveRecord: 22.8ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:21:06 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.7ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.7ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 61ms (Views: 31.0ms | ActiveRecord: 12.2ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:21:09 +0100
Processing by HomeController#index as HTML
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mDocument Load (2.0ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (0.7ms)
  Rendered common/_meta_tags.html.erb (0.1ms)
  Rendered home/_nav.html.erb (0.5ms)
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (1.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (7.4ms)
  Rendered home/_footer.html.erb (0.3ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 42ms (Views: 25.7ms | ActiveRecord: 7.8ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:21:09 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 12ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:21:10 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.6ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.7ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.1ms)
  [1m[36mMembership Load (0.6ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (1.3ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (5.6ms)
  [1m[36mProject Load (0.6ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.3ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (1.1ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (0.8ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (0.9ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (23.1ms)
Completed 200 OK in 122ms (Views: 97.1ms | ActiveRecord: 15.4ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:21:11 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:21:11 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 45ms (Views: 19.4ms | ActiveRecord: 8.9ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:21:12 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.2ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.7ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 61ms (Views: 21.8ms | ActiveRecord: 12.8ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:21:22 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.1ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (1.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (1.4ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 35ms (Views: 0.8ms | ActiveRecord: 12.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:21:33 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.8ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.7ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.2ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 24ms (Views: 1.6ms | ActiveRecord: 7.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:21:43 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (1.0ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.9ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 56ms (Views: 2.6ms | ActiveRecord: 13.7ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:21:53 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (0.9ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.9ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (2.0ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.4ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.8ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 51ms (Views: 2.7ms | ActiveRecord: 11.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:22:03 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.5ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 47ms (Views: 2.6ms | ActiveRecord: 10.1ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=" for 127.0.0.1 at 2014-02-26 16:22:09 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>""}
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.8ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id))
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 48]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 48]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.8ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
Completed 200 OK in 83ms (Views: 53.3ms | ActiveRecord: 13.5ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:22:10 +0100
Processing by HomeController#index as HTML
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mDocument Load (1.0ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (6.2ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 28ms (Views: 17.6ms | ActiveRecord: 5.2ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:22:11 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:22:14 +0100
Processing by WorkspaceController#index as HTML
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mSQL (1.7ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.2ms)[0m  SELECT name, slug FROM "organizations"
  [1m[36mDocument Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1[0m
  Rendered workspace/index.html.erb within layouts/workspace (0.1ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.1ms)
  [1m[35mMembership Load (0.3ms)[0m  SELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1  [["account_id", 1]]
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1[0m  [["account_id", 1]]
  [1m[35m (1.2ms)[0m   select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (5.1ms)
  [1m[35mProject Load (0.7ms)[0m  SELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))
  [1m[36mAccount Load (0.5ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)[0m
  [1m[35mCollaboration Load (0.3ms)[0m  SELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 4]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 4]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 6]]
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 6]]
  [1m[36mAnnotation Count (0.4ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 7]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 7]]
  [1m[35mAnnotation Count (1.0ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 8]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (22.0ms)
Completed 200 OK in 55ms (Views: 28.2ms | ActiveRecord: 16.2ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:22:14 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:22:14 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.1ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.7ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (1.4ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 45ms (Views: 21.2ms | ActiveRecord: 8.6ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:22:15 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.7ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (4.1ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 77ms (Views: 33.6ms | ActiveRecord: 16.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:22:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.3ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.5ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.9ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 2.8ms | ActiveRecord: 12.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:22:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.5ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.4ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.4ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 26ms (Views: 1.0ms | ActiveRecord: 10.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:22:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 21ms (Views: 0.8ms | ActiveRecord: 5.2ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:22:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.9ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (0.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.8ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 48ms (Views: 2.4ms | ActiveRecord: 10.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 42ms (Views: 2.3ms | ActiveRecord: 10.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.2ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.2ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 31ms (Views: 2.3ms | ActiveRecord: 8.4ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 27ms (Views: 0.7ms | ActiveRecord: 9.2ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.6ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.5ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 26ms (Views: 0.7ms | ActiveRecord: 10.8ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 25ms (Views: 0.7ms | ActiveRecord: 9.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:23:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 41ms (Views: 0.7ms | ActiveRecord: 11.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.5ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.7ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 32ms (Views: 2.3ms | ActiveRecord: 6.4ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.2ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.7ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 45ms (Views: 1.5ms | ActiveRecord: 10.7ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.5ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.7ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.9ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 65ms (Views: 3.1ms | ActiveRecord: 13.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.6ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (0.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.3ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.7ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 28ms (Views: 1.0ms | ActiveRecord: 8.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.8ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.5ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 46ms (Views: 2.5ms | ActiveRecord: 12.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:24:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.5ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.2ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 26ms (Views: 1.3ms | ActiveRecord: 6.4ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.9ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (1.1ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 51ms (Views: 2.5ms | ActiveRecord: 13.2ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.9ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 53ms (Views: 2.6ms | ActiveRecord: 12.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 34ms (Views: 1.7ms | ActiveRecord: 11.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.7ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.5ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.9ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.3ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.3ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 34ms (Views: 1.0ms | ActiveRecord: 9.8ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 28ms (Views: 1.2ms | ActiveRecord: 11.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:25:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 54ms (Views: 2.3ms | ActiveRecord: 13.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.9ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.9ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 33ms (Views: 2.4ms | ActiveRecord: 10.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (0.7ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.1ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.5ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (0.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.2ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 21ms (Views: 1.8ms | ActiveRecord: 4.7ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.2ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 22ms (Views: 0.7ms | ActiveRecord: 5.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 47ms (Views: 2.3ms | ActiveRecord: 11.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.7ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 2.3ms | ActiveRecord: 12.4ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:26:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 2.3ms | ActiveRecord: 12.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (1.0ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.9ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.8ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.9ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 43ms (Views: 1.3ms | ActiveRecord: 10.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.3ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 28ms (Views: 1.3ms | ActiveRecord: 10.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.7ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.7ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 2.3ms | ActiveRecord: 12.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.4ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 29ms (Views: 1.2ms | ActiveRecord: 10.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.5ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 26ms (Views: 1.2ms | ActiveRecord: 10.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:27:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 2.3ms | ActiveRecord: 11.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.4ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 31ms (Views: 1.3ms | ActiveRecord: 10.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.7ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.4ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.4ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.5ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 57ms (Views: 2.2ms | ActiveRecord: 10.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.9ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.5ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.7ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 52ms (Views: 2.5ms | ActiveRecord: 12.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.3ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.9ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 37ms (Views: 0.7ms | ActiveRecord: 11.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.3ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (0.9ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 39ms (Views: 2.5ms | ActiveRecord: 9.5ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:28:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.7ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 53ms (Views: 2.7ms | ActiveRecord: 12.6ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.8ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.3ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (2.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 34ms (Views: 0.9ms | ActiveRecord: 11.2ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.5ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.5ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 26ms (Views: 1.2ms | ActiveRecord: 10.9ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 50ms (Views: 0.8ms | ActiveRecord: 12.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:36 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.7ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 42ms (Views: 2.7ms | ActiveRecord: 12.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:46 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.6ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.5ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 44ms (Views: 2.7ms | ActiveRecord: 11.3ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:29:56 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (1.8ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.8ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.6ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.6ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 52ms (Views: 2.4ms | ActiveRecord: 12.8ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:30:06 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.7ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.6ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.8ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 38ms (Views: 2.3ms | ActiveRecord: 11.1ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:30:16 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[35mSQL (1.4ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.1ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mDocument Load (0.6ms)[0m  [1mSELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)[0m
  [1m[35m (1.6ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mAccount Load (0.5ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 35ms (Views: 0.7ms | ActiveRecord: 10.0ms | Solr: 0.0ms)


Started GET "/documents/status.json?ids%5B%5D=40" for 127.0.0.1 at 2014-02-26 16:30:26 +0100
Processing by DocumentsController#status as JSON
  Parameters: {"ids"=>["40"]}
  [1m[36mSQL (1.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.8ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mDocument Load (1.7ms)[0m  SELECT "documents".* FROM "documents" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND "documents"."id" IN (40)
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (40) GROUP BY annotations.document_id[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 ORDER BY "organizations"."id" ASC LIMIT 1  [["id", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1mSELECT "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 ORDER BY "accounts"."id" ASC LIMIT 1[0m  [["id", 1]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 52ms (Views: 2.4ms | ActiveRecord: 12.3ms | Solr: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:30:32 +0100
Processing by HomeController#index as HTML
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mDocument Load (1.3ms)[0m  SELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1
  Rendered home/index.html.erb within layouts/home (0.1ms)
  Rendered common/_meta_tags.html.erb (0.2ms)
  Rendered home/_nav.html.erb (0.1ms)
  [1m[36mSQL (1.2ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.4ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 3 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  Rendered home/_sidebar.html.erb (6.2ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 119ms (Views: 105.5ms | ActiveRecord: 5.3ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:30:32 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:30:34 +0100
Processing by WorkspaceController#index as HTML
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.3ms)[0m  [1mSELECT name, slug FROM "organizations"[0m
  [1m[35mDocument Exists (0.4ms)[0m  SELECT 1 AS one FROM "documents" WHERE "documents"."account_id" = 1 LIMIT 1
  Rendered workspace/index.html.erb within layouts/workspace (0.1ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered accounts/_language_settings.html.erb (0.1ms)
  [1m[36mMembership Load (0.4ms)[0m  [1mSELECT "memberships".* FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."default" = 't' ORDER BY "memberships"."id" ASC LIMIT 1[0m  [["account_id", 1]]
  [1m[35mOrganization Load (0.4ms)[0m  SELECT "organizations".* FROM "organizations" INNER JOIN "memberships" ON "organizations"."id" = "memberships"."organization_id" WHERE "memberships"."account_id" = $1  [["account_id", 1]]
  [1m[36m (0.9ms)[0m  [1m select
 memberships.organization_id, memberships.role,
 accounts.id, accounts.email,
 accounts.first_name, accounts.last_name,
 accounts.hashed_password, accounts.identities,
 accounts.language
 from memberships
 inner join accounts on accounts.id = memberships.account_id
 where
 memberships.role in (1,2,4,0)
 and memberships.organization_id in (1)
and memberships.account_id not in (1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 1 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  Rendered accounts/_current_account.js.erb (4.8ms)
  [1m[36mProject Load (0.6ms)[0m  [1mSELECT "projects".* FROM "projects" WHERE "projects"."hidden" = 'f' AND (account_id = 1 or id in (select project_id from collaborations where account_id = 1))[0m
  [1m[35mAccount Load (0.4ms)[0m  SELECT "accounts".* FROM "accounts" WHERE "accounts"."id" IN (1)
  [1m[36mCollaboration Load (0.3ms)[0m  [1mSELECT "collaborations".* FROM "collaborations" WHERE "collaborations"."project_id" IN (4, 6, 7, 8)[0m
  [1m[35mAnnotation Count (0.6ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 4
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 4]]
  [1m[35m (0.2ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 4]]
  [1m[36mAnnotation Count (1.0ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 6
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 6]]
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 6]]
  [1m[35mAnnotation Count (0.8ms)[0m   select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 7
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)

  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1[0m  [["project_id", 7]]
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)  [["project_id", 7]]
  [1m[36mAnnotation Count (0.9ms)[0m  [1m select count(*) from annotations
 inner join project_memberships on project_memberships.document_id = annotations.document_id
 where project_memberships.project_id = 8
 and (annotations.access in (4, 3) or
 annotations.access = 1 and annotations.account_id = 1)
[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "project_memberships" WHERE "project_memberships"."project_id" = $1  [["project_id", 8]]
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."account_id" FROM "collaborations" WHERE "collaborations"."project_id" = $1 AND (account_id != 1)[0m  [["project_id", 8]]
  Rendered common/_bootstrap.html.erb (21.3ms)
Completed 200 OK in 50ms (Views: 26.0ms | ActiveRecord: 13.4ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:30:34 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:30:34 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.5ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.1ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.1ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 47ms (Views: 19.5ms | ActiveRecord: 10.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:30:36 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.2ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.3ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.3ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (2.5ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.4ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 67ms (Views: 21.6ms | ActiveRecord: 13.3ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=" for 127.0.0.1 at 2014-02-26 16:30:42 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>""}
  [1m[35mSQL (5.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (1.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.8ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id))[0m
  [1m[35mSQL (4.3ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 48]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 48]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
Completed 200 OK in 93ms (Views: 22.4ms | ActiveRecord: 26.0ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=" for 127.0.0.1 at 2014-02-26 16:30:43 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>""}
  [1m[35mSQL (0.8ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.5ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id))[0m
  [1m[35mSQL (3.6ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.8ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 48]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 48]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.7ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.7ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
Completed 200 OK in 92ms (Views: 48.6ms | ActiveRecord: 21.7ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:30:43 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.6ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))[0m
  [1m[35mSQL (3.1ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.1ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 40]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 40]]
Completed 200 OK in 61ms (Views: 27.1ms | ActiveRecord: 16.4ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene+filter%3A+published" for 127.0.0.1 at 2014-02-26 16:30:44 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene filter: published"}
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.6ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1) and documents.access in (4,8,9) and (documents.remote_url is not null or documents.detected_remote_url is not null))[0m
  [1m[35mSQL (1.9ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1) and documents.access in (4,8,9) and (documents.remote_url is not null or documents.detected_remote_url is not null)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
Completed 200 OK in 20ms (Views: 0.4ms | ActiveRecord: 5.7ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=group%3A+ipublic" for 127.0.0.1 at 2014-02-26 16:30:44 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"group: ipublic"}
  [1m[36mSQL (0.6ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (1.5ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.5ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
DEPRECATION WARNING: Calling find_by or find_by! methods with options is deprecated. Build a scope instead, e.g. User.where('age > 21').find_by_name('Jon'). (called from block in build_groups at /home/tino/develop/rails/documentcloud/lib/dc/search/query.rb:269)
  [1m[35mOrganization Load (44.7ms)[0m  SELECT id FROM "organizations" WHERE "organizations"."slug" = 'ipublic' LIMIT 1
  [1m[36m (0.7ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (1.2ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.7ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (2.3ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1))[0m
  [1m[35mSQL (4.4ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 48]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 48]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
Completed 200 OK in 158ms (Views: 50.6ms | ActiveRecord: 69.8ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+2-ivan-testaverde" for 127.0.0.1 at 2014-02-26 16:30:46 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 2-ivan-testaverde"}
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (1.9ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (2))[0m
  [1m[35mSQL (3.1ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (2)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (1.3ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (48) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 48]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 48]]
Completed 200 OK in 30ms (Views: 4.4ms | ActiveRecord: 10.7ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=group%3A+ipublic" for 127.0.0.1 at 2014-02-26 16:30:46 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"group: ipublic"}
  [1m[35mSQL (0.6ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
DEPRECATION WARNING: Calling find_by or find_by! methods with options is deprecated. Build a scope instead, e.g. User.where('age > 21').find_by_name('Jon'). (called from block in build_groups at /home/tino/develop/rails/documentcloud/lib/dc/search/query.rb:269)
  [1m[36mOrganization Load (0.4ms)[0m  [1mSELECT id FROM "organizations" WHERE "organizations"."slug" = 'ipublic' LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.9ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.2ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (1.6ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1))
  [1m[36mSQL (3.3ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (1.2ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 48]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 48]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
Completed 200 OK in 71ms (Views: 34.6ms | ActiveRecord: 16.3ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=group%3A+ipublic" for 127.0.0.1 at 2014-02-26 16:30:48 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"group: ipublic"}
  [1m[36mSQL (0.5ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
DEPRECATION WARNING: Calling find_by or find_by! methods with options is deprecated. Build a scope instead, e.g. User.where('age > 21').find_by_name('Jon'). (called from block in build_groups at /home/tino/develop/rails/documentcloud/lib/dc/search/query.rb:269)
  [1m[35mOrganization Load (0.2ms)[0m  SELECT id FROM "organizations" WHERE "organizations"."slug" = 'ipublic' LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.4ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (2.0ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1))[0m
  [1m[35mSQL (2.3ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.organization_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
  [1m[36m (2.4ms)[0m  [1mSELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id[0m
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 50]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 50]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 49]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 49]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 48]]
  [1m[36mDocdata Load (0.3ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 48]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 47]]
  [1m[36mDocdata Load (0.2ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 47]]
  [1m[35mProjectMembership Load (0.2ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 46]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 46]]
  [1m[35mProjectMembership Load (0.3ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 45]]
  [1m[36mDocdata Load (0.4ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 45]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 44]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 44]]
  [1m[35mProjectMembership Load (0.4ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 43]]
  [1m[36mDocdata Load (0.5ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 43]]
  [1m[35mProjectMembership Load (0.6ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 42]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 42]]
  [1m[35mProjectMembership Load (0.5ms)[0m  SELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1  [["document_id", 41]]
  [1m[36mDocdata Load (0.6ms)[0m  [1mSELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1[0m  [["document_id", 41]]
Completed 200 OK in 85ms (Views: 45.3ms | ActiveRecord: 18.8ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene+filter%3A+published" for 127.0.0.1 at 2014-02-26 16:30:49 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene filter: published"}
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)[0m
  [1m[35mOrganization Load (0.3ms)[0m  SELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC[0m
  [1m[35mMembership Exists (0.2ms)[0m  SELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1  [["account_id", 1]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1) and documents.access in (4,8,9) and (documents.remote_url is not null or documents.detected_remote_url is not null))[0m
  [1m[35mSQL (1.5ms)[0m  SELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1) and documents.access in (4,8,9) and (documents.remote_url is not null or documents.detected_remote_url is not null)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0
Completed 200 OK in 19ms (Views: 0.7ms | ActiveRecord: 4.6ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=account%3A+1-tindaro-tornabene" for 127.0.0.1 at 2014-02-26 16:30:49 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>"account: 1-tindaro-tornabene"}
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.8ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1))
  [1m[36mSQL (1.3ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) AND (documents.account_id in (1)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (0.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 47, 46, 45, 44, 43, 42, 41, 40) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.3ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 40]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 40]]
Completed 200 OK in 47ms (Views: 21.2ms | ActiveRecord: 9.2ms | Solr: 0.0ms)


Started GET "/search/documents.json?per_page=10&order=score&mentions=3&q=" for 127.0.0.1 at 2014-02-26 16:30:49 +0100
Processing by SearchController#documents as JSON
  Parameters: {"per_page"=>"10", "order"=>"score", "mentions"=>"3", "q"=>""}
  [1m[36mSQL (0.8ms)[0m  [1mSELECT DISTINCT "accounts"."id" FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  SELECT "accounts"."id" AS t0_r0, "accounts"."first_name" AS t0_r1, "accounts"."last_name" AS t0_r2, "accounts"."email" AS t0_r3, "accounts"."hashed_password" AS t0_r4, "accounts"."created_at" AS t0_r5, "accounts"."updated_at" AS t0_r6, "accounts"."identities" AS t0_r7, "accounts"."language" AS t0_r8, "accounts"."document_language" AS t0_r9, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "accounts" LEFT OUTER JOIN "memberships" ON "memberships"."account_id" = "accounts"."id" WHERE (memberships.role is NULL or memberships.role != 0) AND "accounts"."id" = 1 AND "accounts"."id" IN (1)
  [1m[36mOrganization Load (0.2ms)[0m  [1mSELECT "organizations".* FROM "organizations" WHERE "organizations"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT "collaborations"."project_id" FROM "collaborations" WHERE "collaborations"."account_id" = 1
  [1m[36mSQL (0.4ms)[0m  [1mSELECT DISTINCT "organizations"."id", "organizations"."id" AS alias_0 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) ORDER BY "organizations"."id" ASC LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  SELECT "organizations"."id" AS t0_r0, "organizations"."name" AS t0_r1, "organizations"."slug" AS t0_r2, "organizations"."created_at" AS t0_r3, "organizations"."updated_at" AS t0_r4, "organizations"."demo" AS t0_r5, "organizations"."language" AS t0_r6, "organizations"."document_language" AS t0_r7, "memberships"."id" AS t1_r0, "memberships"."organization_id" AS t1_r1, "memberships"."account_id" AS t1_r2, "memberships"."role" AS t1_r3, "memberships"."default" AS t1_r4, "memberships"."concealed" AS t1_r5 FROM "organizations" LEFT OUTER JOIN "memberships" ON "memberships"."organization_id" = "organizations"."id" WHERE (memberships.account_id = 1 and memberships.default is true) AND "organizations"."id" IN (1) ORDER BY "organizations"."id" ASC
  [1m[36mMembership Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "memberships" WHERE "memberships"."account_id" = $1 AND "memberships"."role" = 4 AND "memberships"."organization_id" = 1 LIMIT 1[0m  [["account_id", 1]]
  [1m[35m (0.8ms)[0m  SELECT COUNT(DISTINCT "documents"."id") FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id))
  [1m[36mSQL (2.8ms)[0m  [1mSELECT "documents"."id" AS t0_r0, "documents"."organization_id" AS t0_r1, "documents"."account_id" AS t0_r2, "documents"."access" AS t0_r3, "documents"."page_count" AS t0_r4, "documents"."title" AS t0_r5, "documents"."slug" AS t0_r6, "documents"."source" AS t0_r7, "documents"."language" AS t0_r8, "documents"."description" AS t0_r9, "documents"."calais_id" AS t0_r10, "documents"."publication_date" AS t0_r11, "documents"."created_at" AS t0_r12, "documents"."updated_at" AS t0_r13, "documents"."related_article" AS t0_r14, "documents"."detected_remote_url" AS t0_r15, "documents"."remote_url" AS t0_r16, "documents"."publish_at" AS t0_r17, "documents"."text_changed" AS t0_r18, "documents"."hit_count" AS t0_r19, "documents"."public_note_count" AS t0_r20, "documents"."reviewer_count" AS t0_r21, "documents"."file_size" AS t0_r22, "documents"."char_count" AS t0_r23, "documents"."original_extension" AS t0_r24, "documents"."file_hash" AS t0_r25, "accounts"."id" AS t1_r0, "accounts"."first_name" AS t1_r1, "accounts"."last_name" AS t1_r2, "accounts"."email" AS t1_r3, "accounts"."hashed_password" AS t1_r4, "accounts"."created_at" AS t1_r5, "accounts"."updated_at" AS t1_r6, "accounts"."identities" AS t1_r7, "accounts"."language" AS t1_r8, "accounts"."document_language" AS t1_r9, "organizations"."id" AS t2_r0, "organizations"."name" AS t2_r1, "organizations"."slug" AS t2_r2, "organizations"."created_at" AS t2_r3, "organizations"."updated_at" AS t2_r4, "organizations"."demo" AS t2_r5, "organizations"."language" AS t2_r6, "organizations"."document_language" AS t2_r7 FROM "documents" LEFT OUTER JOIN "accounts" ON "accounts"."id" = "documents"."account_id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "documents"."organization_id" left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as memberships
 on memberships.document_id = documents.id WHERE ((documents.access in (4,8,9)) or (documents.access in (1, 5, 7, 2, 3) and documents.account_id = 1) or (documents.access in (2, 3) and documents.organization_id = 1) or (memberships.document_id = documents.id)) ORDER BY documents.created_at desc LIMIT 10 OFFSET 0[0m
  [1m[35m (1.7ms)[0m  SELECT COUNT(*) AS count_all, annotations.document_id AS annotations_document_id FROM "annotations" left outer join memberships on
 (annotations.organization_id = memberships.organization_id and
 memberships.account_id = 1)

 left outer join
 (select distinct document_id from project_memberships
 where project_id in (4,6,7,8)) as projects
 on projects.document_id = annotations.document_id WHERE (((annotations.access in (4,8,9)) or (annotations.access = 1 and annotations.account_id = 1) or (annotations.access = 3 and annotations.organization_id = memberships.organization_id) or ((annotations.access = 3) and projects.document_id = annotations.document_id))) AND "annotations"."document_id" IN (50, 49, 48, 47, 46, 45, 44, 43, 42, 41) GROUP BY annotations.document_id
  [1m[36mProjectMembership Load (0.3ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 50]]
  [1m[35mDocdata Load (0.6ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 50]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 49]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 49]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 48]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 48]]
  [1m[36mProjectMembership Load (0.6ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 47]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 47]]
  [1m[36mProjectMembership Load (0.1ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 46]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 46]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 45]]
  [1m[35mDocdata Load (0.1ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 45]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 44]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 44]]
  [1m[36mProjectMembership Load (0.4ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 43]]
  [1m[35mDocdata Load (0.2ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 43]]
  [1m[36mProjectMembership Load (0.2ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 42]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 42]]
  [1m[36mProjectMembership Load (0.5ms)[0m  [1mSELECT "project_memberships".* FROM "project_memberships" WHERE "project_memberships"."document_id" = $1[0m  [["document_id", 41]]
  [1m[35mDocdata Load (0.4ms)[0m  SELECT "docdata".* FROM "docdata" WHERE "docdata"."document_id" = $1 ORDER BY "docdata"."id" ASC LIMIT 1  [["document_id", 41]]
Completed 200 OK in 72ms (Views: 37.4ms | ActiveRecord: 14.5ms | Solr: 0.0ms)


Started GET "/logout" for 127.0.0.1 at 2014-02-26 16:31:14 +0100
Processing by AuthenticationController#logout as HTML
Redirected to https://dev.dcloud.org/
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)


Started GET "/" for 127.0.0.1 at 2014-02-26 16:31:14 +0100
Processing by WorkspaceController#index as HTML
Redirected to https://dev.dcloud.org/home
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)


Started GET "/home" for 127.0.0.1 at 2014-02-26 16:31:14 +0100
Processing by HomeController#index as HTML
  [1m[36mDocument Load (1.1ms)[0m  [1mSELECT "documents".* FROM "documents" WHERE "documents"."access" IN (4, 8, 9) AND (remote_url is not null or detected_remote_url is not null) AND (hit_count > 100) ORDER BY random() LIMIT 1[0m
  Rendered home/index.html.erb within layouts/home (0.0ms)
  Rendered common/_meta_tags.html.erb (0.0ms)
  Rendered home/_nav.html.erb (0.1ms)
  Rendered home/_sidebar.html.erb (0.2ms)
  Rendered home/_footer.html.erb (0.0ms)
  Rendered common/_bootstrap.html.erb (0.1ms)
Completed 200 OK in 23ms (Views: 19.0ms | ActiveRecord: 1.1ms | Solr: 0.0ms)


Started GET "/assets/core.jst" for 127.0.0.1 at 2014-02-26 16:31:14 +0100
Processing by Jammit::Controller#package as */*
  Parameters: {"package"=>"core", "extension"=>"jst"}
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Solr: 0.0ms)
New RightAws::S3Interface using shared connections mode
Opening new HTTP connection to s3.amazonaws.com:80
New RightAws::S3Interface using shared connections mode
Opening new HTTP connection to s3.ipublic.org:8080
New RightAws::S3Interface using shared connections mode
Opening new HTTP connection to s3.ipublic.org:8080
New RightAws::S3Interface using shared connections mode
Opening new HTTP connection to s3.ipublic.org:8080
